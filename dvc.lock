schema: '2.0'
stages:
  preprocess:
    cmd: python src/preprocess.py
    deps:
    - path: ../LoadTraces/spec06/473.astar-s1.txt.xz
      md5: fc15414dd9ef7e04f2fda20bd459cef2
      size: 31279168
    - path: src/data_loader.py
      md5: 4c9a609303cf8083e09b98317235dd7d
      size: 1421
    - path: src/preprocess.py
      md5: 382bc84ee0fe32fa3c8c77d439c6950b
      size: 8832
      isexec: true
    params:
      params.yaml:
        apps.app: 473.astar-s1.txt.xz
        hardware:
          block-bits: 6
          total-bits: 64
          look-back: 9
          pred-forward: 128
          page-bits: 12
          delta-bound: 128
          split-bits: 6
          filter-size: 16
          bitmap-size: 256
          block-num-bits: 58
        system:
          gpu-id: 0
          traces: ../LoadTraces/spec06
          processed: processed
          model: model
        teacher.number: 5
        trace-data:
          train: 2
          total: 3
          skip: 1
          batch-size: 256
    outs:
    - path: processed/df_test_1.pt
      md5: 5330d3d725bc241da0493411ecca02e7
      size: 3363635
    - path: processed/df_test_2.pt
      md5: 33cbbdf3f050f5ea45e4e770b8d7fe75
      size: 65040307
    - path: processed/df_test_3.pt
      md5: 913c8f5c196130441e59cbf369fc1166
      size: 13639923
    - path: processed/df_test_4.pt
      md5: dcf520d6ea756bc40f2f8492a19bbe59
      size: 10817459
    - path: processed/df_test_5.pt
      md5: 87926061b0daee9f3ee35a3c6f08e137
      size: 3636915
    - path: processed/df_test_stu.pt
      md5: 9f254a023ef6536a8eca22cb23f62831
      size: 95502519
    - path: processed/test_loader_1.pt
      md5: 7abb6a8ffa8c6b0fe17391e6e2c88c53
      size: 3677307
    - path: processed/test_loader_2.pt
      md5: 03c425b835c1b667f828e0f00bcb20fb
      size: 71425851
    - path: processed/test_loader_3.pt
      md5: 8b5b4a699cfde5d396311b3982ceb787
      size: 14950395
    - path: processed/test_loader_4.pt
      md5: 69b275b1d21392b17ebef3d3c01d4a96
      size: 11850427
    - path: processed/test_loader_5.pt
      md5: 356190fcaf1f05d24f7b2b4ed6936236
      size: 3977915
    - path: processed/test_loader_stu.pt
      md5: 5b6ed2d01fa6580506f03f77894d26bb
      size: 104891071
    - path: processed/train_loader_1.pt
      md5: 41264025282d375788607e368f3b7c7e
      size: 10040509
    - path: processed/train_loader_2.pt
      md5: a3884a2c43cf55a98ffb80113e47eeaf
      size: 133867389
    - path: processed/train_loader_3.pt
      md5: f2c7a97c4c2e1d86ea8c9018abacada1
      size: 11247933
    - path: processed/train_loader_4.pt
      md5: 33f7f49b9217c4f6a03f3b02555f60bc
      size: 12043325
    - path: processed/train_loader_5.pt
      md5: 23a79ef51792abeafe9f07d3ae0a7450
      size: 10426493
  train-tchs:
    cmd: python src/train_tch.py
    deps:
    - path: processed/test_loader_1.pt
      md5: 7abb6a8ffa8c6b0fe17391e6e2c88c53
      size: 3677307
    - path: processed/test_loader_2.pt
      md5: 03c425b835c1b667f828e0f00bcb20fb
      size: 71425851
    - path: processed/test_loader_3.pt
      md5: 8b5b4a699cfde5d396311b3982ceb787
      size: 14950395
    - path: processed/test_loader_4.pt
      md5: 69b275b1d21392b17ebef3d3c01d4a96
      size: 11850427
    - path: processed/test_loader_5.pt
      md5: 356190fcaf1f05d24f7b2b4ed6936236
      size: 3977915
    - path: processed/train_loader_1.pt
      md5: 41264025282d375788607e368f3b7c7e
      size: 10040509
    - path: processed/train_loader_2.pt
      md5: a3884a2c43cf55a98ffb80113e47eeaf
      size: 133867389
    - path: processed/train_loader_3.pt
      md5: f2c7a97c4c2e1d86ea8c9018abacada1
      size: 11247933
    - path: processed/train_loader_4.pt
      md5: 33f7f49b9217c4f6a03f3b02555f60bc
      size: 12043325
    - path: processed/train_loader_5.pt
      md5: 23a79ef51792abeafe9f07d3ae0a7450
      size: 10426493
    - path: src/train_tch.py
      md5: 0be3007aa65572b327b96d063cc41fbb
      size: 4242
    params:
      params.yaml:
        hardware:
          block-bits: 6
          total-bits: 64
          look-back: 9
          pred-forward: 128
          page-bits: 12
          delta-bound: 128
          split-bits: 6
          filter-size: 16
          bitmap-size: 256
          block-num-bits: 58
        model.tch_v:
          dim: 256
          depth: 8
          heads: 10
          mlp-dim: 256
          channels: 1
        system:
          gpu-id: 0
          traces: ../LoadTraces/spec06
          processed: processed
          model: model
        teacher:
          number: 5
          models:
          - v
          - v
          - v
          - v
          - v
        train:
          epochs: 50
          lr: 0.0002
          gamma: 0.1
          step-size: 20
          early-stop: 10
          alpha: 0.5
          temperature: 5
    outs:
    - path: model/teacher_1.pth
      md5: a0d152ffd89b8073bfeae965d927814e
      size: 88465545
    - path: model/teacher_2.pth
      md5: 0f8b539a019fcf1ad2f2236b7b24975f
      size: 88465545
    - path: model/teacher_3.pth
      md5: 9ffd594586fd6275556d64a7d67c7507
      size: 88465545
    - path: model/teacher_4.pth
      md5: 32ea1d3d297cb6fd80b89aa70df1ca69
      size: 88465545
    - path: model/teacher_5.pth
      md5: 958c6fbee4506d2565033e903da90633
      size: 88465545
    - path: res/plots/metrics/train_tch_1/test_loss.tsv
      md5: 3c95d15307b1e7c2bb14766c4503417c
      size: 1163
    - path: res/plots/metrics/train_tch_1/train_loss.tsv
      md5: 67ebdafd1817e7dc364edd9ba5d26a09
      size: 1176
    - path: res/plots/metrics/train_tch_2/test_loss.tsv
      md5: 388162ae8798c6edd07c75a0dab63958
      size: 895
    - path: res/plots/metrics/train_tch_2/train_loss.tsv
      md5: df2340df6d8713fb783089fcb994fcb0
      size: 896
    - path: res/plots/metrics/train_tch_3/test_loss.tsv
      md5: 111226c503fa0b7d4a12e38569f42f1d
      size: 1166
    - path: res/plots/metrics/train_tch_3/train_loss.tsv
      md5: 3e79fb9ee9365ddd17d724d011b707e3
      size: 1171
    - path: res/plots/metrics/train_tch_4/test_loss.tsv
      md5: 83108e5e5f4853b579b02af045dbdb82
      size: 1166
    - path: res/plots/metrics/train_tch_4/train_loss.tsv
      md5: 301dc6a603a27f1a69654ba0c4918a3b
      size: 1172
    - path: res/plots/metrics/train_tch_5/test_loss.tsv
      md5: 1718ab2375a627df05a3f6aae46a914b
      size: 1159
    - path: res/plots/metrics/train_tch_5/train_loss.tsv
      md5: 07424d32d76a1f5dceeae37578331598
      size: 1167
  validate-tchs:
    cmd: python src/validate_tch.py
    deps:
    - path: model/teacher_1.pth
      md5: a0d152ffd89b8073bfeae965d927814e
      size: 88465545
    - path: model/teacher_2.pth
      md5: 0f8b539a019fcf1ad2f2236b7b24975f
      size: 88465545
    - path: model/teacher_3.pth
      md5: 9ffd594586fd6275556d64a7d67c7507
      size: 88465545
    - path: model/teacher_4.pth
      md5: 32ea1d3d297cb6fd80b89aa70df1ca69
      size: 88465545
    - path: model/teacher_5.pth
      md5: 958c6fbee4506d2565033e903da90633
      size: 88465545
    - path: processed/df_test_1.pt
      md5: 5330d3d725bc241da0493411ecca02e7
      size: 3363635
    - path: processed/df_test_2.pt
      md5: 33cbbdf3f050f5ea45e4e770b8d7fe75
      size: 65040307
    - path: processed/df_test_3.pt
      md5: 913c8f5c196130441e59cbf369fc1166
      size: 13639923
    - path: processed/df_test_4.pt
      md5: dcf520d6ea756bc40f2f8492a19bbe59
      size: 10817459
    - path: processed/df_test_5.pt
      md5: 87926061b0daee9f3ee35a3c6f08e137
      size: 3636915
    - path: processed/test_loader_1.pt
      md5: 7abb6a8ffa8c6b0fe17391e6e2c88c53
      size: 3677307
    - path: processed/test_loader_2.pt
      md5: 03c425b835c1b667f828e0f00bcb20fb
      size: 71425851
    - path: processed/test_loader_3.pt
      md5: 8b5b4a699cfde5d396311b3982ceb787
      size: 14950395
    - path: processed/test_loader_4.pt
      md5: 69b275b1d21392b17ebef3d3c01d4a96
      size: 11850427
    - path: processed/test_loader_5.pt
      md5: 356190fcaf1f05d24f7b2b4ed6936236
      size: 3977915
    - path: src/validate_tch.py
      md5: b68f6126d3ab805872399055609370e2
      size: 6705
    params:
      params.yaml:
        apps.app: 473.astar-s1.txt.xz
        hardware:
          block-bits: 6
          total-bits: 64
          look-back: 9
          pred-forward: 128
          page-bits: 12
          delta-bound: 128
          split-bits: 6
          filter-size: 16
          bitmap-size: 256
          block-num-bits: 58
        model.tch_v:
          dim: 256
          depth: 8
          heads: 10
          mlp-dim: 256
          channels: 1
        system:
          gpu-id: 0
          traces: ../LoadTraces/spec06
          processed: processed
          model: model
        teacher:
          number: 5
          models:
          - v
          - v
          - v
          - v
          - v
